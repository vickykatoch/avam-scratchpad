"use strict";!function(){function e(e,i){var t="function"==typeof e;return t?e:e&&i}function i(e,i){this.grid=e,this.options=i||{}}i.prototype.name="TreeView",i.prototype.setRelation=function(i){var t=this.grid,o=t.behavior,n=o.dataModel;if(i){var l=window.fin.Hypergrid.analytics;o.setPipeline([e(this.options.includeFilter,l.DataSourceTreeviewFilter),e(this.options.includeSorter,l.DataSourceTreeviewSorter),l.DataSourceTreeview],{stash:"default"})}var r=n.findDataSourceByType("treeviewer"),s=r.setRelation(i&&this.options),a=o.getColumnProperties(r.treeColumn.index),c=t.properties;if(s){if(this.editableWas=!!a.editable,a.editable=!1,this.cellSelectionWas=!!a.cellSelection,a.cellSelection=!1,this.checkboxOnlyRowSelectionsWas=c.checkboxOnlyRowSelections,c.checkboxOnlyRowSelections=!0,this.options.hideIdColumns){var d=[r.idColumn.index,r.parentIdColumn.index];d.forEach(function(e){var i=o.getActiveColumnIndex(e);void 0!==i&&o.columns.splice(i,1)})}o.reindex()}else a.editable=this.editableWas,a.cellSelection=this.cellSelectionWas,c.checkboxOnlyRowSelections=this.checkboxOnlyRowSelectionsWas,o.unstashPipeline();return t.selectionModel.clear(),t.clearMouseDown(),s&&r},i.prototype.deleteRow=function(e,i,t,o){var n,l,r="number"==typeof i||null===i,s=0,a=this.grid.behavior.dataModel,c=a.findDataSourceByType("treeviewer"),d=(c.idColumn=this.options.idColumn).name,u=(c.parentIdColumn=this.options.parentIdColumn).name;if(r||(o=t,t=i,i=void 0),i&&!a.source.findRow(d,i))throw"Adoptive parent row not found.";if(n=t?a.getRowById:a.deleteRowById,l=n.call(a,d,e))for(t?o||delete l.__EXPANDED:s++;l=a.source.findRow(u,e);)r?l[u]=i:s+=this.deleteRow(l[d]);return s},window.fin.Hypergrid.TreeView=i}();